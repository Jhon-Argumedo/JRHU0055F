<div class="container">
    <div class="row">
        <div class="col-12">
            <nav class="mt-4"
                style="--bs-breadcrumb-divider: url(&#34;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E&#34;);"
                aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                        <a routerLink="/dashboard" class="text-decoration-none">Inicio</a>
                    </li>
                    <li class="breadcrumb-item active" aria-current="page">Incapacidades Radicadas</li>
                </ol>
            </nav>
        </div>
        <div class="bg-white sticky-top py-2">
            <p class="fs-1 text-center fw-light">Incapacidades Radicadas</p>
            <hr>
        </div>
        <small class="text-muted mb-2">Aqui podras gestionar todas las incapacidades radicadas, viendo toda la información
            necesaria.
        </small>
        <div class="col-12" *ngIf="isLoading">
            <div class="h-100 p-3 bg-light border rounded-4 text-center align-items-center d-flex">
                <strong class="option-tipo">El historial de incapacidades estan cargando....</strong>
                <div class="spinner-border ms-auto" role="status" aria-hidden="true"></div>
            </div>
        </div>
        <div class="col-12" *ngIf="!isLoading">
            <p-table #dtIncapacidades
                dataKey="id"
                [value]="incapacidades" 
                [paginator]="true"
                [rows]="10"
                [showCurrentPageReport]="true"
                [tableStyle]="{ 'min-width': '50rem' }"
                currentPageReportTemplate="Pagina {first} - {last} de {totalRecords} registros"
                [globalFilterFields]="getGlobalFilterFields()"
                [styleClass]="'p-datatable-sm'"
                [rowsPerPageOptions]="[10, 25, 50]">

                <ng-template pTemplate="caption">
                    <div class="justify-content-between d-flex">
                        <button (click)="clearTable(dtIncapacidades)" class="btn btn-warning btn-sm">
                            <i class="fa-solid fa-filter-circle-xmark"></i>
                        </button>
                        <span class="p-input-icon-left ml-auto">
                            <i class="pi pi-search"></i>
                            <input pInputText class="form-control" type="text" (input)="filter(dtIncapacidades, $event)" placeholder="Escribe para buscar..." />
                        </span>
                    </div>
                </ng-template>

                <ng-template pTemplate="header">
                    <tr>
                        <th scope="col" pSortableColumn="numeroRadicado" style="width: 12%;">N° radicado</th>
                        <th scope="col" pSortableColumn="estado" style="width: 8%;">Estado</th>
                        <th scope="col" pSortableColumn="nombreEmpresa" style="width: 17%;">Empresa</th>
                        <th scope="col" pSortableColumn="tipoIncapacidad" style="width: 25%;">Tipo Incapacidad</th>
                        <th scope="col" pSortableColumn="fechaInicial" style="width: 15%;">Fecha Inicio</th>
                        <th scope="col" pSortableColumn="fechaFinal" style="width: 10%;">Fecha Fin</th>
                        <th scope="col" pSortableColumn="fechaDeRadicacion" style="width: 20%;">Fecha Radicacion</th>
                        <th scope="col" style="width: 5%;">Detalles</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-i>
                    <tr>
                        <td>{{ i.numeroRadicado }}</td>
                        <td>
                            {{ i.estadoObservacionTrabajador.toUpperCase() }}
                        </td>
                        <td>{{ i.nombreEmpresa }}</td>
                        <td>{{ i.tipoIncapacidad }}</td>
                        <td>{{ i.fechaInicial | date: 'dd/MM/yyyy'}}</td>
                        <td>{{ i.fechaFinal | date: 'dd/MM/yyyy'}}</td>
                        <td>{{ i.fechaRadicacion | date: 'dd/MM/yyyy'}}</td>
                        <td class="text-center">
                            <button (click)="viewDetailsIncapacidad(i, modal)"
                            type="button"
                            class="btn btn-info rounded-pill btn-sm">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="paginatorleft">
                    <p-button type="button" icon="pi pi-plus" styleClass="p-button-text"></p-button>
                </ng-template>
                <ng-template pTemplate="paginatorright">
                    <p-button type="button" icon="pi pi-cloud" styleClass="p-button-text"></p-button>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>

<ng-template #modal let-c="close" let-d="dismiss">
    <div class="modal-content shadow">
        <div class="modal-header">
            <p class="fs-2 mb-0 mt-2 text-center">
                <i class="fa-solid fa-magnifying-glass text-info fs-2 me-3"></i>
                <span class="fw-light">Radicación #</span>
                <strong>{{incapacidadSelected.numeroRadicado}}</strong>
            </p>
            <button type="button" class="btn-close" aria-label="Close" (click)="d('Cross click')"></button>
        </div>
        <div class="modal-body">
            <div class="row">
                <div class="col">
                    <p class="mb-0 fw-bold">
                        <span class="text-dark">Empresa: </span>
                        <span class="text-muted">{{ incapacidadSelected.nombreEmpresa }}</span>
                    </p>
                    <p class="mb-0 fw-bold">
                        <span class="text-dark">Numero contrato: </span>
                        <span class="text-muted">{{ incapacidadSelected.numeroContrato }}.</span>
                    </p>
                    <p class="mb-0 fw-bold">
                        <span class="text-dark">Fecha de radicacion: </span>
                        <span class="text-muted">{{ incapacidadSelected.fechaRadicacion | date: 'dd/MM/yyyy'}}.</span>
                    </p>
                    <p class="mb-0 fw-bold">
                        <span class="text-dark">Estado: </span>
                        <span class="text-muted">{{ incapacidadSelected.estadoObservacionTrabajador.toUpperCase() }}.</span>
                    </p>
                    <p class="mb-0 fw-bold">
                        <span class="text-dark">Seguro: </span>
                        <span class="text-muted">{{ incapacidadSelected.nombreEps }}.</span>
                    </p>
                    <p class="mb-0 fw-bold">
                        <span class="text-dark">Periodo de incapacidad: </span>
                        <span class="text-muted">{{ incapacidadSelected.fechaInicial | date: 'dd/MM/yyyy'}} - {{ incapacidadSelected.fechaFinal | date: 'dd/MM/yyyy'}}.</span>
                    </p>
                    <p class="mb-0 fw-bold">
                        <span class="text-dark">Tipo de incapacidad: </span>
                        <span class="text-muted">{{ incapacidadSelected.tipoIncapacidad }}.</span>
                    </p>
                    <p class="mb-0 fw-bold">
                        <span class="text-dark">Subtipo de incapacidad: </span> 
                        <span class="text-muted">{{ incapacidadSelected.subTipoIncapacidad }}.</span>
                    </p>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            
        </div>
    </div>
</ng-template>